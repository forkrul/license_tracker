# Quickstart: License Tracker

## Installation

```bash
# From PyPI (once published)
pip install license-tracker

# From source
git clone https://github.com/forkrul/license_tracker
cd license_tracker
pip install -e .
```

## Basic Usage

### Generate Attribution Documentation

```bash
# Scan poetry.lock and generate licenses.md
license-tracker gen --scan poetry.lock

# Scan Pipfile.lock
license-tracker gen --scan Pipfile.lock

# Scan requirements.txt
license-tracker gen --scan requirements.txt

# Scan installed environment
license-tracker gen --env

# Include root project in output
license-tracker gen --scan poetry.lock --include-root
```

### Custom Output

```bash
# Specify output file
license-tracker gen --scan poetry.lock --output docs/LICENSES.md

# Use custom Jinja2 template
license-tracker gen --scan poetry.lock --template my_template.j2

# Download license files locally
license-tracker gen --scan poetry.lock --download
```

### Compliance Check

```bash
# Check against forbidden licenses
license-tracker check --scan poetry.lock --forbidden "GPL-3.0,AGPL-3.0"

# Use allowed list instead
license-tracker check --scan poetry.lock --allowed "MIT,Apache-2.0,BSD-3-Clause"
```

### GitHub API Rate Limits

For projects with 60+ dependencies, provide a GitHub token:

```bash
# Via environment variable
export GITHUB_TOKEN=ghp_xxxxxxxxxxxx
license-tracker gen --scan poetry.lock

# Via flag
license-tracker gen --scan poetry.lock --github-token ghp_xxxxxxxxxxxx
```

## Example Output

Running `license-tracker gen --scan poetry.lock` produces:

```markdown
# Open Source License Attribution

This project utilizes the following open source libraries:

| Library | Version | License | Source |
|---------|---------|---------|--------|
| [requests](https://requests.readthedocs.io) | 2.31.0 | [Apache-2.0](https://github.com/psf/requests/blob/main/LICENSE) | [GitHub](https://github.com/psf/requests) |
| [click](https://palletsprojects.com/p/click/) | 8.1.7 | [BSD-3-Clause](https://github.com/pallets/click/blob/main/LICENSE.rst) | [GitHub](https://github.com/pallets/click) |
| [typing-extensions](https://pypi.org/project/typing-extensions/) | 4.8.0 | [PSF-2.0](https://spdx.org/licenses/PSF-2.0.html) | [PyPI](https://pypi.org/project/typing-extensions/) |

---
*Generated by [license_tracker](https://github.com/forkrul/license_tracker)*
```

## Configuration File

Create `license_tracker.toml` for persistent configuration:

```toml
[license_tracker]
# Default scan source
default_scan = "poetry.lock"

# Output configuration
output = "docs/licenses.md"
include_root = true

# Template
template = "templates/custom_license.j2"

# Compliance
forbidden_licenses = ["GPL-3.0", "AGPL-3.0"]

# Vendorized dependencies (manual additions)
[[vendorized]]
name = "internal-lib"
version = "1.0.0"
license = "MIT"
url = "https://internal.example.com/license"
```

## CI/CD Integration

### GitHub Actions

```yaml
name: License Compliance

on: [push, pull_request]

jobs:
  license-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install license-tracker
        run: pip install license-tracker

      - name: Check licenses
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          license-tracker check --scan poetry.lock --forbidden "GPL-3.0,AGPL-3.0"

      - name: Generate attribution
        run: |
          license-tracker gen --scan poetry.lock --output licenses.md

      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: licenses
          path: licenses.md
```

### Pre-commit Hook

```yaml
# .pre-commit-config.yaml
repos:
  - repo: https://github.com/forkrul/license_tracker
    rev: v1.0.0
    hooks:
      - id: license-tracker
        args: ["gen", "--scan", "poetry.lock", "--output", "licenses.md"]
        files: poetry.lock
```

## Programmatic Usage

```python
from license_tracker import scan_poetry_lock, resolve_licenses, generate_markdown

# Scan dependencies
packages = scan_poetry_lock("poetry.lock")

# Resolve licenses (async)
import asyncio
metadata = asyncio.run(resolve_licenses(packages))

# Generate output
markdown = generate_markdown(metadata, include_root=True)
print(markdown)
```

## Troubleshooting

### GitHub Rate Limit Exceeded

```
Error: GitHub API rate limit exceeded (60/hour for unauthenticated requests)
```

**Solution**: Provide a GitHub token via `GITHUB_TOKEN` env var or `--github-token` flag.

### Package Not Found on PyPI

```
Warning: Could not resolve metadata for 'my-internal-package'
```

**Solution**: Add to `license_tracker.toml` as a vendorized dependency.

### Unknown License Format

```
Warning: Could not parse license 'Custom License' for package 'xyz'
```

**Solution**: License will fall back to showing the raw string. Consider adding a manual override.
